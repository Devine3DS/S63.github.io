<script>
  // Setze scrollRestoration auf "manual", um das automatische Scrollen zu verhindern
  if (history.scrollRestoration) {
    history.scrollRestoration = "manual";
  }

  document.addEventListener('keydown', function(e) {
    if (e.key === "Escape" || e.key === "Backspace") {
      // Speichern der aktuellen Scroll-Position
      const scrollPosition = window.scrollY;

      // Entferne den Hash ohne die Seite neu zu laden oder die Position zu verändern
      history.replaceState(null, null, window.location.pathname);

      // Schließe die Lightbox
      window.location.hash = "";

      // Setze die Scroll-Position nach dem Entfernen des Hashes zurück
      window.scrollTo(0, scrollPosition);
    }
  });

  // Verhindere das Scrollen der Seite beim Schließen der Lightbox
  window.addEventListener("hashchange", function(event) {
    // Verhindert das automatische Scrollen der Seite auf den Anfang
    event.preventDefault();
    var target = document.querySelector(window.location.hash);
    if (target) {
      window.scrollTo(0, target.offsetTop);
    }
  });
</script>